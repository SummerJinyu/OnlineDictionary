function [ D2 ] = dictionaryUpdate( D1, A2, B2, m, k, diff,aa)

D2 = D1;
D1 = D2 - 1;
count = 0;
diffnow = 100; % big numbe
while (norm(D1-D2)> diff)
    D1 = D2;
    for j = 1:k
        %update the j-th cols of D1:
        uj = 1/A2(j,j)*(B2(:,j) - D2*A2(:,j)) + D2(:,j);
        D2(:,j) = 1/max(norm(uj),1)*uj;
    end
    count = count + 1
    norm(D2-D1)
    
    %aa(count) = norm(D2-D1);
end
end

